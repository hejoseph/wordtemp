<div class="container">
  <h2>Word Template Processor</h2>
  <p>Upload a .docx file with merge fields (e.g., «nom_societe_client») to get started.</p>

  <div 
    class="drop-zone" 
    appFileDrop
    (fileDropped)="onFileDropped($event)">
    <div class="file-input-container">
      <label for="file-upload" class="custom-file-upload">
        Choose Word Document
      </label>
      <input id="file-upload" type="file" (change)="onFileChange($event)" accept=".docx" />
      <p>or drag and drop a file here</p>
    </div>
  </div>

  <div *ngIf="isLoading" class="loader"></div>

  <div *ngIf="tags.length > 0 && !isLoading" class="tags-container">
    <h3>Fill Merge Fields</h3>
    <div *ngFor="let tag of tags" class="tag-input">
      <label>{{ tag }}</label>
      <input type="text" [(ngModel)]="tagValues[tag]" placeholder="Enter value for {{ tag }}" />
    </div>
    <button (click)="generateDocument()" class="generate-btn">Generate Document</button>
  </div>

  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>
</div>
